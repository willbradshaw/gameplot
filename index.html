<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>My Video Game Journey</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/7.8.5/d3.min.js"></script>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="container">
        <h1>üéÆ My Video Game Journey</h1>
        <p class="subtitle">Comprehensive analysis of games played: timeline, ratings by genre, and playtime relationships</p>
        
        <div class="stats" id="stats"></div>
        
        <div class="controls">
            <div class="control-section">
                <div class="control-header">
                    <div class="control-title">Platforms</div>
                    <div class="control-buttons">
                        <button class="filter-btn" onclick="selectAllPlatforms()">All</button>
                        <button class="filter-btn" onclick="clearPlatformFilters()">None</button>
                    </div>
                </div>
                <div class="platform-checkboxes" id="platformCheckboxes"></div>
            </div>
            
            <div class="control-section">
                <div class="control-header">
                    <div class="control-title">Tags</div>
                    <div class="control-buttons">
                        <button class="filter-btn" onclick="selectAllTags()">All</button>
                        <button class="filter-btn" onclick="clearTagFilters()">None</button>
                    </div>
                </div>
                <div class="tag-search-container">
                    <input type="text" id="tagSearch" placeholder="Search tags..." class="tag-search-input">
                </div>
                <div class="tag-checkboxes" id="tagCheckboxes"></div>
            </div>
            
            <div class="control-section">
                <div class="control-header">
                    <div class="control-title">Status</div>
                    <div class="control-buttons">
                        <button class="filter-btn" onclick="selectAllStatuses()">All</button>
                        <button class="filter-btn" onclick="clearStatusFilters()">None</button>
                    </div>
                </div>
                <div class="platform-checkboxes" id="statusCheckboxes"></div>
            </div>
            
            <div class="control-section">
                <div class="control-header">
                    <div class="control-title">Ratings</div>
                    <div class="control-buttons">
                        <button class="filter-btn" onclick="selectAllRatings()">All</button>
                        <button class="filter-btn" onclick="clearRatingFilters()">None</button>
                    </div>
                </div>
                <div class="platform-checkboxes" id="ratingCheckboxes"></div>
            </div>
            
            <div class="control-section">
                <div class="control-header">
                    <div class="control-title">Date Range</div>
                    <div class="control-buttons">
                        <button class="filter-btn" onclick="clearDateFilter()">Reset</button>
                    </div>
                </div>
                <div class="date-range">
                    <div class="date-input-group">
                        <label for="startDate">From</label>
                        <input type="date" id="startDate">
                    </div>
                    <div class="date-input-group">
                        <label for="endDate">To</label>
                        <input type="date" id="endDate">
                    </div>
                </div>
            </div>
            
            <div class="control-section reset-section">
                <button class="reset-all-btn" onclick="resetAllFilters()">üîÑ Reset All Filters</button>
            </div>
        </div>

        <div class="table-container">
            <div class="table-header">
                <h2 style="color: #ffffff; text-align: center; margin-bottom: 20px;">üìã Games Table</h2>
                <div class="table-controls">
                    <div class="search-container">
                        <input type="text" id="gameSearch" placeholder="Search games..." class="search-input">
                        <button class="clear-search-btn" onclick="clearGameSearch()" title="Clear search">‚úï</button>
                    </div>
                    <button class="download-csv-btn" onclick="downloadTableAsCSV()">üì• Download CSV</button>
                </div>
            </div>
            <div class="table-wrapper">
                <table id="gamesTable" class="games-table">
                    <thead>
                        <tr>
                            <th class="sortable" data-column="game">Game <span class="sort-indicator"></span></th>
                            <th class="sortable" data-column="platforms">Platforms <span class="sort-indicator"></span></th>
                            <th class="sortable" data-column="rating">Rating <span class="sort-indicator"></span></th>
                            <th class="sortable" data-column="lastPlayedTotal">Last Played <span class="sort-indicator"></span></th>
                            <th class="sortable" data-column="hoursPlayedTotal">Hours Played <span class="sort-indicator"></span></th>
                            <th class="sortable" data-column="status">Status <span class="sort-indicator"></span></th>
                            <th class="sortable" data-column="tags">Tags <span class="sort-indicator"></span></th>
                        </tr>
                    </thead>
                    <tbody id="gamesTableBody">
                        <!-- Table rows will be populated by JavaScript -->
                    </tbody>
                </table>
            </div>
            <div class="table-info">
                <span id="tableRowCount">Loading...</span>
            </div>
        </div>

        <div class="chart-container" style="margin-top: 30px;">
            <h2 style="color: #ffffff; text-align: center; margin-bottom: 20px;">üìÖ Last Played vs Rating</h2>
            <div class="chart" id="chart"></div>
            <div class="zoom-instructions">
                üîç Scroll to zoom ‚Ä¢ Click and drag to pan ‚Ä¢ Hover over points for details
            </div>
        </div>

        <div class="chart-container" style="margin-top: 30px;">
            <h2 style="color: #ffffff; text-align: center; margin-bottom: 20px;">üìä Playtime by Category</h2>
            <div class="aggregation-controls" id="playtimeAggregationControls" style="text-align: center; margin-bottom: 20px;">
                <!-- Aggregation type buttons will be populated by JavaScript -->
            </div>
            <div class="chart" id="playtimeAggregationChart" style="height: 500px; overflow: hidden;"></div>
            <div class="zoom-instructions">
                üìä Total playtime aggregated by category ‚Ä¢ Switch between Platform, Tag, Status, and Rating views ‚Ä¢ Hover over bars for details
            </div>
        </div>

        <div class="chart-container" style="margin-top: 30px;">
            <h2 style="color: #ffffff; text-align: center; margin-bottom: 20px;">‚è±Ô∏è Playtime vs Rating</h2>
            <div class="chart" id="playtimeChart" style="height: 600px; overflow: hidden;"></div>
            <div class="zoom-instructions">
                üéÆ Playtime vs rating relationship ‚Ä¢ Scroll to zoom ‚Ä¢ Click and drag to pan ‚Ä¢ Hover over points for details
            </div>
        </div>
    </div>

    <div class="tooltip" id="tooltip"></div>

    <script type="module" src="src/render/main.js"></script>
</body>
</html>
